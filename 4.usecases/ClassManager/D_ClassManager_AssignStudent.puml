@startuml AD_ClassManager_AssignStudent
!pragma layout smetana
title Activity Diagram: Phân công sinh viên vào lớp học (Popup)

start
:Truy cập từ danh sách lớp học\n(btn "Phân công sinh viên");

if (Có quyền truy cập?) then (Có)
  :Hiển thị popup phân công sinh viên\n(**SCR_AssignStudent**);

    :Chọn sinh viên (1 hoặc nhiều);
    :Nhập điều kiện tìm kiếm (nếu cần);

    switch (Thao tác?)
      case (Lưu)
        :Kiểm tra trùng phân công / trạng thái SV;
          if (Hợp lệ & không trùng?) then (Đúng)
            :Ghi nhận phân công sinh viên vào lớp;
              if (Ghi thành công?) then (Có)
                :Thông báo "Phân công sinh viên thành công";
                :Đóng popup;
                :Cập nhật/Chuyển về danh sách\n(**SCR_ClassManager**);
              else (Không)
                :Thông báo lỗi hệ thống;
                :Chuyển về danh sách\n(**SCR_ClassManager**);
              endif
          else (Trùng/không hợp lệ)
            :Thông báo "Sinh viên đã được phân công vào lớp học khác hoặc không hợp lệ";
            :Ở lại popup\n(**SCR_AssignStudent**);
          endif

      case (Đóng)
        :Đóng popup;
        :Quay lại danh sách lớp học\n(**SCR_ClassManager**);
    endswitch

else (Không)
  :Thông báo không có quyền truy cập;
  :Đóng popup;
  :Chuyển hướng đến trang chính;
endif
stop
@enduml
